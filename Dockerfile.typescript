FROM local/claude:latest

USER root
SHELL ["/bin/bash", "-o", "pipefail", "-c"]

RUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - \
 && apt-get install -y --no-install-recommends nodejs=20.* \
 && apt-get clean \
 && rm -rf /var/lib/apt/lists/*

# グローバルパッケージ（TypeScript系 & Claude Code CLI）
RUN npm install -g \
    typescript \
    ts-node \
    @types/node \
    yarn \
    pnpm \
    @anthropic-ai/claude-code@1.0.24

USER ${USERNAME}
WORKDIR /workspace
